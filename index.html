<!doctype html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang=""> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8" lang=""> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9" lang=""> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang=""> <!--<![endif]-->
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
	<title>Unreal Web Server - User Manual</title>
	<meta name="description" content="">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="apple-touch-icon" href="apple-touch-icon.png">

	<link rel="stylesheet" href="css/bootstrap.min.css">
	<style>
		body {
			padding-top: 50px;
			padding-bottom: 20px;
		}
	</style>
	<link rel="stylesheet" href="css/bootstrap-theme.min.css">
	<link rel="stylesheet" href="css/main.css">

	<script src="js/vendor/modernizr-2.8.3-respond-1.4.2.min.js"></script>
</head>
<body>
        <!--[if lt IE 8]>
            <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
            <![endif]-->
            <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
            	<div class="container">
            		<div class="navbar-header">
            			<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            				<span class="sr-only">Toggle navigation</span>
            				<span class="icon-bar"></span>
            				<span class="icon-bar"></span>
            				<span class="icon-bar"></span>
            			</button>
            			<a class="navbar-brand" href="#">Unreal Web Server</a>
            		</div>
            		<div id="navbar" class="navbar-collapse collapse">
            		</div><!--/.navbar-collapse -->
            	</div>
            </nav>

            <!-- Main jumbotron for a primary marketing message or call to action -->
            <div class="jumbotron">
            	<div class="container">
            		<h1>User Manual</h1>
            	</div>
            </div>

            <div class="container">
            	<div class="row">
            		<h1>Introduction to Web servers</h1>
            	</div>

            	<div class="row">
            		<div class="col-md-6">
            			<h3>Summary</h3>
            			<p>At the most basic level, whenever a browser needs a file hosted on a web server, the browser requests the file via HTTP. When the request reaches the HTTP server, it sends the requested document back, also through HTTP.</p>
            			<p>To fetch a web page, as we already said, your browser sends a request to the web server, which proceeds to search for the requested file in its own storage space. When the file is found, the server reads it, processes it, if required, and sends it to the browser. Let's look at those steps in more details.</p>
            		</div>
            		<div class="col-md-6">
            			<img src="img/web-server.svg" alt="Basic representation of a client/server connection through HTTP" style="height: 200px; width: 600px;">
            		</div>
            	</div>
            	<br/>
            	<div class="row">
            		<div class="col-md-6">
            			<img src="img/how_web_servers_work_1.gif" alt="Basic representation of a client/server connection through HTTP">
            		</div>
            		<div class="col-md-6">
            			<h3>Hosting files</h3>
            			<p>A web server first has to store the website's files, namely all HTML documents and their related assets, including images, CSS stylesheets, JavaScript files, fonts, and videos.</p>
            		</div>
            	</div>
            	<br/>
            	<div class="row">
            		<div class="col-md-12">
            			<h3>Communicating through HTTP</h3>
            			<p>Secondly, a web server provides support for HTTP (<strong>H</strong>yper<strong>t</strong>ext <strong>T</strong>ransfer <strong>P</strong>rotocol). As its name implies it, HTTP specifies how to transfer hypertext (i.e., linked web documents) between two computers.</p>
            			<p>A <em>protocol</em> is a set of rules for the communication between two computers. HTTP is a textual, stateless protocol.</p>
            			<dl>
            				<dt>Textual</dt>
            				<dd>All commands are plain-text and human-readable.</dd>
            				<dt>Stateless</dt>
            				<dd>Neither the server nor the client remember the previous communications. For example, relying on HTTP alone, a server cannot remember a password you typed or what step you're on in a transaction. You need an application server for tasks like that (we'll cover that kind of technology in further articles).</dd>
            			</dl>
            			<p>HTTP provides clear rules on how a client and a server communicate:</p>
            			<ul>
            				<li>Only <em>clients</em> can make HTTP requests, and then only <em>to servers. </em>Servers can only<em> respond</em> to a <em>client's</em> HTTP request.</li>
            				<li>When requesting a file via HTTP, the clients must provide the file's URL.</li>
            				<li>The web server <em>must answer</em> every HTTP request, at least with an error message.</li>
            			</ul>
            			<p>On a web server, the HTTP server is responsible for processing and answering incoming requests.</p>
            			<ol>
            				<li>When receiving a request, an HTTP server first checks whether the requested URL matches an existing file.</li>
            				<li>If so, the web server sends the file content back to the browser. If not, an application server builds the necessary file.</li>
            				<li>If neither process is possible, the web server returns an error message to the browser, most commonly "404 Not Found".</li>
            			</ol>
            		</div>
            	</div>
            	<br/>
            	<div class="row">
            		<div class="col-md-4">
            			<h3>Unreal Web Server features.</h3>
            			<p>As we explained, just like a usual web server, UWS can serve static files: HTML files, CSS stylesheets, JavaScript files, fonts, and videos. You just have to specify the root folder of your files in the UWS startup configuration.</p>
            			<p>But the real power of UWS is its ability to communicate with Unreal Engine Blueprints. Thanks to this, UWS becomes a dynamic web server able to process the content and generate it on the fly from your games variables.</p>
            		</div>
            		<div class="col-md-8">
            			<img src="img/schema.png" alt="UWS" style="height: 300px;">
            		</div>
            	</div>
            	<br/>
            	<hr>
            	<div class="row">
            		<h1>Beginning with UWS</h1>
            	</div>
            	<div class="row">
            		<div class="col-md-4">
            			<img src="img/enable.png" alt="UWS" style="height: 150px;">
            		</div>
            		<div class="col-md-8">
            			<h2>Enable plugin</h2>
            			<p>To get started, first ensure that the plugin is installed, by visiting the Plugin Window. Then, enable the plugin if it's not already done.</p>
            			<p>All blueprints nodes explained in the following manual can be found in <b>UnrealWebServer</b> category.</p>
            		</div>
            	</div>
            	<br/>
            	<div class="row">
            		<div class="col-md-6">
            			<h2>Get, Start, Stop server</h2>
            			<p>Unreal Web Server's main class is a <a href="https://en.wikipedia.org/wiki/Singleton_pattern">Singleton</a> (that restricts the instantiation of the UWS class to one object). You can GET this class anywhere in your blueprints using the function <b>GetOrCreateWebServerInstance</b>. As it name means, this function will get the UWS instance if it exists. Otherwise, this function will create it. In each case, a UWS instance is returned.</p>
            			<p>Once you have this instance, you can start it using the StartServer function. This function needs :</p>
            			<ul>
            				<li><b>Port</b> as integer: this is the port on which UWS will start listening. By default the port is 8080 but usual web servers runs on port 80. You just need to be sure that this port is not already used (or will not be) on the computer.</li>
            				<li><b>DocumentRoot</b> as String: this is the folder path where UWS will parse your static (HTML) files. For instance, "www" path means that the files needs to be in the "www" folder in your <b>game contents</b>. This parameter is optional.</li>
            			</ul>
            		</div>
            		<div class="col-md-6">
            			<img src="img/start.png" alt="UWS" style="height: 300px;" >
            		</div>
            		<div class="col-md-12">
            			<p>We strongly recommend starting the server in the level blueprint, in the BeginPlay event.</p>
            			<p>The server needs to be properly stopped. You must use the StopServer function (in the EndPlay event for instance) to do this job and avoid further issues.</p>
            			<p>At this step, you should be able to access to your UWS by navigating at http://127.0.0.1:8080 (assuming 8080 is the server port) in a web browser. Because you don't have set any web file or URI handler, the response will be "404 Not found".</p>
            		</div>
            	</div>

            	<br/>
            	<div class="row">
            		<div class="col-md-5">
            			<img src="img/handler.png" alt="UWS" style="height: 170px;" >
            		</div>
            		<div class="col-md-7">
            			<h2>Register URI handlers</h2>
            			<p>Once the UWS is properly running, you can add URI Handlers. A URI Handler is needed to map a specific URL to a specific Unreal behavior (blueprint event).</p>
            			<p>A URI handler is registered by using the <b>AddURIHandler</b> function. This function needs :</p>
            			<ul>
            				<li><b>Path</b> as String: this is the path where you want to map to a handler. For instance "/" means http://127.0.0.1:8080/ in the web browser, "/test" means http://127.0.0.1:8080/test, and so on...</li>
            				<li><b>Method</b> as EHTTPRequestMethodEnum: this is the HTTP method needed for request mapping. If you select GET method and a POST request comes, this handler will not be used. You can specify "*" in order to listen all HTTP methods.</li>
            				<li><b>Callback</b> as Delegate with a <b>Connection</b> parameter: this is the event fired when a connection is handled on this URL with the HTTP method handled. This event provides us a Connection object (it will be explained in a next section).</li>
            			</ul>

            		</div>
            		<div class="col-md-12">
            			<p>Of course, you can either create a custom event or map a function to the callback, such as on the picture.</p>
            			<div class="alert alert-warning">
            				<strong>Warning!</strong> The delegate fires the event outside of the game thread. It means you <strong>can't modify some gameobjects</strong> directly in this event. We suggest you to save the value you want to update in the gameobject and do the job in the Tick event.
            			</div>
            		</div>
            	</div>
            	<br/>
            	<hr>
            	<div class="row">
            		<h1>Create your custom handlers</h1>
            	</div>
            	<div class="row">
            		<div class="col-md-6">
            			<h2>Incoming variables</h2>
            			<p>Browser can send data to the server in several ways: headers, POST variables, GET variables, COOKIES variables, etc...</p>
            			<p>With UWS, you can use this data in your blueprints. These data are stored in the <b>Connection</b> object. Then you just have to use the following functions:</p>
            			<ul>
            				<li><b>GetHeader</b> to retrieve a header value using its name (eg. "User-Agent" header stores browser data).</li>
            				<li><b>GetGETVar</b> to retrieve a <a href="https://en.wikipedia.org/wiki/GET_(HTTP)" >GET</a> value. GET variables are recognizable in the URL. They are sent this way: http://127.0.0.1:8080/test?var1=value1&var2=value2</li>
            				<li><b>GetPOSTVar</b> to retrieve a <a href="https://en.wikipedia.org/wiki/POST_(HTTP)" >POST</a> value. Basically, Post variables are sent through forms. These variables are hidden: unlike GET vars, they don't appear in the URL.</li>
            				<li><b>GetCOOKIEVar</b> to retrieve a <a href="https://en.wikipedia.org/wiki/HTTP_cookie" >COOKIE</a> value. Cookies values are stored in Cookies. This data is stored by the browser and is shared through a whole website. You can use cookies as an authentication proof, for instance.</li>
            			</ul>
            			<p>For each one of these functions, the name of the variable to retrieve, as String, is needed as parameter. The return value is also a String. If the variable isn't found, the returned value is empty.</p>
            		</div>
            		<div class="col-md-6">
            			<img src="img/get.png" alt="UWS" style="height: 500px;" >
            		</div>
            	</div>
            	<br/>
            	<div class="row">
            		<div class="col-md-6">
            			<img src="img/response.png" alt="UWS" style="height: 200px;" >
            		</div>
            		<div class="col-md-6">
            			<h2>Send response</h2>
            			<p>In order to provide data to the client browser, you need to send a Response.</p>
            			<p>Response can be fully qualified using response status code, cookies, content type and redirection.</p>
            			<p>First of all, you can send a basic response in a comprehensive way by using the function <b>ConstructResponseExt</b> and specifying the response content. Basically, this function will create a new response, fill in the content with our value and set the response status code to 200 Found.</p>
            			<p>Once the response built, you have to send it with the <b>SendResponse</b> function.</p>
            		</div>
            	</div>
            	<div class="alert alert-warning">
            		<strong>Warning!</strong> The time needed by the event to complete and send the response will impact the performance. If your function lasts 2000ms to be completed and to send the response, the client browser will be stuck for at least 2000ms.
            	</div>
            	<br/>
            	<div class="row">
            		<div class="col-md-6">
            			<h2>Enhanced response</h2>
            			<p>You can enhance your response by specifying the response code, cookies, etc...</p>
            			<p>You can use <b>ConstructResponse</b> tu construct an empty response. Then save its reference and complete the response with other functions</p>
            			<p>You can add a cookie to this response. Such as <b>ConstructResponseExt</b>, <b>ConstructCookieExt</b> can be used to create a Cookie object with a name and a value. Remember, this cookie will be stored in the client's browser.</p>
            			<p>Cookie can be customized with a max age, a specific domain, etc...</p>
            		</div>
            		<div class="col-md-6">
            			<img src="img/cookie.png" alt="UWS" style="height: 300px;" >
            		</div>
            	</div>
            	<br/>
            	<hr>
            	<div class="row">
            		<h1>Static files (HTML, CSS, JS, etc...)</h1>
            	</div>
            	<div class="row">
            		<div class="col-md-8">
            			<img src="img/fps.png" alt="UWS" style="height: 200px;" >
            		</div>
            		<div class="col-md-4">
            			<h2>Style and Javascript </h2>
            			<p>To improve your web pages, you can use CSS files, Javascript, etc...</p>
            			<p>For instance, using JQuery, you can retrieve values periodically (e.g. realtime FPS meter). And compute these variables into javascript (e.g. create a graph with FPS over the time).</p>
            		</div>
            	</div>
            	<br/>
            	<div class="row">
            		<div class="col-md-6">
            			<h2>Responsive </h2>
            			<p>Of course you can create your web pages in a responsive way. A smartphone or a tablet can control or receive data from our game.</p>
            		</div>
            		<div class="col-md-6">
            			<img src="img/smartphone.jpg" alt="UWS" style="height: 350px;" >
            		</div>
            	</div>
            	<br/>

            	<hr>
            	<div class="row">
            		<h1>Performances</h1>
            	</div>

            	<div class="row">
            		<div class="col-md-8">
            			<img src="img/perfs.png" alt="UWS" style="height: 400px;" >
            		</div>
            		<div class="col-md-4">
            			<h2>Average response time</h2>
            			<p>The following performances have been reported in local: web browser and UWS were on the same computer.</p>
            			<p>The average time between the client URL request and the server computation is about 3.5ms.</p>
            			<p>The average time between the response submission and the client reception is about 2.5ms.</p>
            			<p>The rest of the time is the time needed by Unreal to compute the callback function.</p>
            			<p>With simple functions, such as sending back a variable, you can easily reach below 5ms to receive a response.</p>
            			<p>Of course, if the web browser is on another computer, the network lag will be added to these values</p>
            		</div>
            	</div>
            	<br/>
            	<hr>
            	<div class="row">
            		<h1>Packaging</h1>
            	</div>
            	<div class="row">
            		<div class="col-md-12">
            			<h2>HTML files path</h2>
            			<p>The <b>DocumentRoot</b> path when you start the web server can be either relative of absolute. If this path is absolute, packaging will not change the path. However, if the path is relative, this folder must be located in the content folder of the packaged project.</p>
            			<p>For instance, if your packaged project has the name TESTPROJECT, the html files folder must be in <i>PackagedProjectPath/TESTPROJECT/Content/</i> folder.</p>
            		</div>
            	</div>
            	<br/>
            	<hr>
            	<footer>
            		<p>&copy; Isara Technologies 2017</p>
            	</footer>
            </div> <!-- /container -->
            <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
            <script>window.jQuery || document.write('<script src="js/vendor/jquery-1.11.2.min.js"><\/script>')</script>

            <script src="js/vendor/bootstrap.min.js"></script>

            <script src="js/main.js"></script>
        </body>
        </html>
